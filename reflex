#!/usr/bin/env bash
# reflex <surfraw-elvis> [i]    -> i == interactive
# A tiny wrapper for surfraw that searches the highlighted text with a chosen web service.

set -euo pipefail

command -v surfraw >/dev/null || { echo "surfraw is not installed." >&2; exit 1; }

elvis=${1:?Usage: $0 <surfraw_elvis> [i]}
interactive=${2:-}

if [[ $interactive ]]; then
    query=$(rofi -dmenu -p "$elvis > ")
else
    # I use wayland, replace this with your environment's equivalent.
    query=$(wl-paste --primary --no-newline)
fi

[[ -z "$query" ]] && exit 0

# Let surfraw handle the browser invocation.
surfraw "$elvis" -browser=vivaldi-stable $query &>/dev/null &
